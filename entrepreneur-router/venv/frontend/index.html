<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>IntelliRoute Pro | –°–∏—Å—Ç–µ–º–∞ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏—è –º–∞—Ä—à—Ä—É—Ç–æ–≤</title>
    <link rel="stylesheet" href="src/styles/main.css">
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
</head>
<body>
       <!-- Main App -->
    <div id="app" class="hidden">
        <!-- Sidebar Navigation -->
        <nav id="sidebar" class="sidebar">
            <div class="sidebar-header">
                <div class="logo">
                    <div class="logo-icon">üöÄ</div>
                    <span class="logo-text">IntelliRoute</span>
                </div>
                <button class="sidebar-toggle" id="sidebarToggle">
                    <div class="hamburger">‚â°</div>
                </button>
            </div>

            <div class="nav-section">
                <div class="nav-label">–û–°–ù–û–í–ù–´–ï</div>
                <a href="#planner" class="nav-item active" data-section="planner">
                    <div class="nav-icon">üó∫Ô∏è</div>
                    <span class="nav-text">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span>
                    <div class="nav-badge">8</div>
                </a>
                <a href="#map" class="nav-item" data-section="map">
                    <div class="nav-icon">üìç</div>
                    <span class="nav-text">–ö–∞—Ä—Ç–∞</span>
                </a>
                <a href="#analytics" class="nav-item" data-section="analytics">
                    <div class="nav-icon">üìä</div>
                    <span class="nav-text">–ê–Ω–∞–ª–∏—Ç–∏–∫–∞</span>
                </a>
            </div>

            <div class="nav-section">
                <div class="nav-label">–ò–ù–°–¢–†–£–ú–ï–ù–¢–´</div>
                <a href="#optimization" class="nav-item" data-section="optimization">
                    <div class="nav-icon">‚ö°</div>
                    <span class="nav-text">–û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</span>
                    <div class="nav-badge pro">AI</div>
                </a>
                <a href="#schedule" class="nav-item" data-section="schedule">
                    <div class="nav-icon">üïê</div>
                    <span class="nav-text">–†–∞—Å–ø–∏—Å–∞–Ω–∏–µ</span>
                </a>
                <a href="#settings" class="nav-item" data-section="settings">
                    <div class="nav-icon">‚öôÔ∏è</div>
                    <span class="nav-text">–ù–∞—Å—Ç—Ä–æ–π–∫–∏</span>
                </a>
            </div>

            <div class="sidebar-footer">
                <div class="user-profile">
                    <div class="user-avatar" id="userAvatar">EP</div>
                    <div class="user-info">
                        <div class="user-name" id="userName">–ò–≤–∞–Ω –ü–µ—Ç—Ä–æ–≤</div>
                        <div class="user-status">Online</div>
                    </div>
                </div>
            </div>
        </nav>

        <!-- Main Content -->
        <main id="mainContent" class="main-content">
            <!-- Top Header -->
            <header class="top-header">
                <div class="header-left">
                    <h1 class="page-title" id="pageTitle">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫ –º–∞—Ä—à—Ä—É—Ç–æ–≤</h1>
                    <div class="breadcrumb" id="breadcrumb">
                        <span class="breadcrumb-item">–ì–ª–∞–≤–Ω–∞—è</span>
                        <span class="breadcrumb-separator">/</span>
                        <span class="breadcrumb-item active">–ü–ª–∞–Ω–∏—Ä–æ–≤—â–∏–∫</span>
                    </div>
                </div>
                
                <!-- <div class="header-stats">
                    <div class="stat-item">
                        <span class="stat-value">8</span>
                        <span class="stat-label">—Ç–æ—á–µ–∫</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">2—á 15–º</span>
                        <span class="stat-label">–≤—Ä–µ–º—è</span>
                    </div>
                    <div class="stat-item">
                        <span class="stat-value">45–∫–º</span>
                        <span class="stat-label">–¥–∏—Å—Ç–∞–Ω—Ü–∏—è</span>
                    </div>
                </div> -->
                
                <div class="header-actions">
                    <div class="time-date-widget">
                      <div class="current-time" id="currentTime">--:--:--</div>
                      <div class="time-separator">|</div>
                      <div class="current-date" id="currentDate">--.--.----</div>
                  </div>
                </div>
            </header>

            <!-- Content Sections -->
            <div class="content-sections">
                <!-- Planner Section -->
                <section id="plannerSection" class="content-section active">
                    <div class="planner-grid">
                        <!-- Left Column - Input -->
                        <div class="planner-column">
                            <div class="input-card">
                                <div class="card-header">
                                    <h3>üìã –¢–æ—á–∫–∏ –º–∞—Ä—à—Ä—É—Ç–∞ (<span id="pointsCount">0</span>)</h3>
                                    <div class="card-actions">
                                      <button class="icon-btn" id="templateBtn" title="–°–∫–∞—á–∞—Ç—å —à–∞–±–ª–æ–Ω">
                                        üìã –®–∞–±–ª–æ–Ω
                                    </button>
                                        <button class="icon-btn" id="importExcelBtn" title="–ò–º–ø–æ—Ä—Ç Excel">
                                            üìÅ Excel
                                        </button>
                                        <button class="icon-btn" id="exportExcelBtn" title="–≠–∫—Å–ø–æ—Ä—Ç Excel">
                                            üíæ –≠–∫—Å–ø–æ—Ä—Ç
                                        </button>
                                        <button class="icon-btn" id="addAddressBtn" title="–î–æ–±–∞–≤–∏—Ç—å –∞–¥—Ä–µ—Å">
                                            ‚ûï –î–æ–±–∞–≤–∏—Ç—å
                                        </button>
                                    </div>
                                </div>
                                
                                <div class="filters-bar">
                                    <div class="search-box">
                                        <input type="text" id="searchAddress" placeholder="–ü–æ–∏—Å–∫ –ø–æ –∞–¥—Ä–µ—Å—É...">
                                        <div class="search-icon">üîç</div>
                                    </div>
                                    <label class="filter-checkbox">
                                        <input type="checkbox" id="filterVIP">
                                        <span class="checkmark"></span>
                                        –¢–æ–ª—å–∫–æ VIP –∫–ª–∏–µ–Ω—Ç—ã
                                    </label>
                                </div>
                                
                                <div class="address-list" id="addressList">
                                    <!-- Address items will be dynamically generated -->
                                </div>

                                <div class="card-footer">
                                    <button class="btn btn-secondary" id="clearAllBtn">
                                        üóëÔ∏è –û—á–∏—Å—Ç–∏—Ç—å –≤—Å–µ
                                    </button>
                                    <button class="btn btn-primary" id="optimizeBtn">
                                        ‚ö° –û–ø—Ç–∏–º–∏–∑–∏—Ä–æ–≤–∞—Ç—å
                                    </button>
                                </div>
                            </div>

                            <div class="settings-card">
                                <h3>‚öôÔ∏è –ü–∞—Ä–∞–º–µ—Ç—Ä—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
                                <div class="settings-grid">
                                    <div class="form-group">
                                        <label class="form-label">–ö—Ä–∏—Ç–µ—Ä–∏–π –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</label>
                                        <select class="form-input" id="optimizationCriteria">
                                            <option value="time">–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è –≤—Ä–µ–º–µ–Ω–∏</option>
                                            <option value="distance">–ú–∏–Ω–∏–º–∏–∑–∞—Ü–∏—è —Ä–∞—Å—Å—Ç–æ—è–Ω–∏—è</option>
                                            <option value="balanced">–°–±–∞–ª–∞–Ω—Å–∏—Ä–æ–≤–∞–Ω–Ω—ã–π</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">–¢–∏–ø —Ç—Ä–∞–Ω—Å–ø–æ—Ä—Ç–∞</label>
                                        <select class="form-input" id="transportType">
                                            <option value="car">üöó –ê–≤—Ç–æ–º–æ–±–∏–ª—å</option>
                                            <option value="public">üöå –û–±—â–µ—Å—Ç–≤–µ–Ω–Ω—ã–π</option>
                                            <option value="walking">üö∂ –ü–µ—à–∫–æ–º</option>
                                        </select>
                                    </div>
                                    <div class="form-group">
                                        <label class="form-label">–í—Ä–µ–º–µ–Ω–Ω—ã–µ –æ–∫–Ω–∞</label>
                                        <div class="time-windows" style="display: flex; gap: 8px; align-items: center;">
                                            <input type="time" class="form-input" id="startTime" value="09:00" style="flex: 1;">
                                            <span>‚Äî</span>
                                            <input type="time" class="form-input" id="endTime" value="18:00" style="flex: 1;">
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <!-- Right Column - Results & Map -->
                        <div class="planner-column">
                            <!-- <div class="results-card">
                                <div class="card-header">
                                    <h3>üìä –†–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏</h3>
                                    <div class="optimization-badge">
                                        <span class="badge-text">GNN AI</span>
                                    </div>
                                </div>
                                
                                <div class="results-content">
                                    <div class="metrics-grid">
                                        <div class="metric-card">
                                            <div class="metric-value" id="totalTime">2—á 15–º</div>
                                            <div class="metric-label">–û–±—â–µ–µ –≤—Ä–µ–º—è</div>
                                            <div class="metric-trend up">+15%</div>
                                        </div>
                                        <div class="metric-card">
                                            <div class="metric-value" id="totalDistance">45 –∫–º</div>
                                            <div class="metric-label">–†–∞—Å—Å—Ç–æ—è–Ω–∏–µ</div>
                                            <div class="metric-trend down">-12%</div>
                                        </div>
                                        <div class="metric-card">
                                            <div class="metric-value" id="pointsCountResult">8</div>
                                            <div class="metric-label">–¢–æ—á–µ–∫</div>
                                        </div>
                                        <div class="metric-card">
                                            <div class="metric-value" id="fuelSavings">125 ‚ÇΩ</div>
                                            <div class="metric-label">–≠–∫–æ–Ω–æ–º–∏—è</div>
                                        </div>
                                    </div>
                                </div>
                            </div> -->

                            <!-- <div class="map-card">
                                <div class="card-header">
                                    <h3>üó∫Ô∏è –ö–∞—Ä—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
                                    <div class="card-actions">
                                        <button class="icon-btn" onclick="app.setMapType('standard')" title="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞">üó∫Ô∏è</button>
                                        <button class="icon-btn" onclick="app.setMapType('satellite')" title="–°–ø—É—Ç–Ω–∏–∫">üõ∞Ô∏è</button>
                                        <button class="icon-btn" onclick="app.buildRouteOnMap()" title="–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç">üöó</button>
                                        <button class="icon-btn" onclick="app.clearRoute()" title="–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç">üóëÔ∏è</button>
                                    </div>
                                </div>
                                <div class="map-container">
                                    <div id="mapPreview"></div>
                                </div>
                            </div> -->
                            <!-- –í —Ä–∞–∑–¥–µ–ª–µ –∫–∞—Ä—Ç—ã –º–∞—Ä—à—Ä—É—Ç–∞ -->
<div class="map-card">
    <div class="card-header">
        <h3>üó∫Ô∏è –ö–∞—Ä—Ç–∞ –º–∞—Ä—à—Ä—É—Ç–∞</h3>
        <div class="card-actions">
            <button class="icon-btn" onclick="app.setMapType('standard')" title="–°—Ç–∞–Ω–¥–∞—Ä—Ç–Ω–∞—è –∫–∞—Ä—Ç–∞">üó∫Ô∏è</button>
            <button class="icon-btn" onclick="app.setMapType('satellite')" title="–°–ø—É—Ç–Ω–∏–∫">üõ∞Ô∏è</button>
            <button class="icon-btn" onclick="app.buildRouteOnMap()" title="–ü–æ—Å—Ç—Ä–æ–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç">üöó</button>
            <button class="icon-btn" onclick="app.clearRoute()" title="–û—á–∏—Å—Ç–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç">üóëÔ∏è</button>
        </div>
    </div>
    
    <!-- –û–∫–æ—à–∫–æ —Å –º–µ—Ç—Ä–∏–∫–∞–º–∏ –Ω–∞ –∫–∞—Ä—Ç–µ -->
    <div class="map-metrics-overlay">
        <h4>–≠–∫–æ–Ω–æ–º–∏—è –º–∞—Ä—à—Ä—É—Ç–∞</h4>
        <div class="map-metrics-grid">
            <div class="map-metric-item">
                <div class="map-metric-value" id="mapTotalTime">2—á 15–º</div>
                <div class="map-metric-label">–í—Ä–µ–º—è</div>
                <div class="map-metric-trend up">+15%</div>
            </div>
            <div class="map-metric-item">
                <div class="map-metric-value" id="mapTotalDistance">45 –∫–º</div>
                <div class="map-metric-label">–î–∏—Å—Ç–∞–Ω—Ü–∏—è</div>
                <div class="map-metric-trend down">-12%</div>
            </div>
            <div class="map-metric-item">
                <div class="map-metric-value" id="mapFuelSavings">125 ‚ÇΩ</div>
                <div class="map-metric-label">–≠–∫–æ–Ω–æ–º–∏—è</div>
            </div>
            <div class="map-metric-item">
                <div class="map-metric-value" id="mapPointsCount">8</div>
                <div class="map-metric-label">–¢–æ—á–µ–∫</div>
            </div>
        </div>
    </div>
    
    <div class="map-container">
        <div id="mapPreview"></div>
    </div>
</div>
                        </div>
                    </div>
                </section>

                <!-- Map Section -->
                <section id="mapSection" class="content-section">
                    <div class="section-header">
                        <h2>–ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω–∞—è –∫–∞—Ä—Ç–∞</h2>
                        <p>–†–µ–∞–ª—å–Ω–æ–µ –≤—Ä–µ–º—è –∏ —Ç—Ä–∞—Ñ–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–µ 2–ì–ò–°</p>
                    </div>
                    <div class="full-map-container">
                        <div id="fullMap"></div>
                    </div>
                </section>

                <!-- Analytics Section -->
                <section id="analyticsSection" class="content-section">
                    <div class="section-header">
                        <h2>–ê–Ω–∞–ª–∏—Ç–∏–∫–∞ –∏ –æ—Ç—á–µ—Ç—ã</h2>
                        <p>–°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏ –º–µ—Ç—Ä–∏–∫–∏ —ç—Ñ—Ñ–µ–∫—Ç–∏–≤–Ω–æ—Å—Ç–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤</p>
                    </div>
                    <div class="analytics-content" id="analyticsContent">
                        <!-- Analytics content will be loaded here -->
                    </div>
                </section>

                <!-- Optimization Section -->
                <section id="optimizationSection" class="content-section">
                    <div class="section-header">
                        <h2>AI –û–ø—Ç–∏–º–∏–∑–∞—Ü–∏—è</h2>
                        <p>–ü—Ä–æ–¥–≤–∏–Ω—É—Ç—ã–µ –∞–ª–≥–æ—Ä–∏—Ç–º—ã –æ–ø—Ç–∏–º–∏–∑–∞—Ü–∏–∏ –º–∞—Ä—à—Ä—É—Ç–æ–≤</p>
                    </div>
                    <div class="optimization-content" id="optimizationContent">
                        <!-- Optimization content will be loaded here -->
                    </div>
                </section>

                <!-- Schedule Section -->
                <section id="scheduleSection" class="content-section">
                  <div class="section-header">
                      <h2>üìÖ –î–µ—Ç–∞–ª—å–Ω–æ–µ –ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–∏–µ –º–∞—Ä—à—Ä—É—Ç–æ–≤</h2>
                      <p>–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ —Ä–∞—Å–ø–∏—Å–∞–Ω–∏—è —Å —É—á–µ—Ç–æ–º —Ä–∞–±–æ—á–∏—Ö —á–∞—Å–æ–≤ –∏ –æ–±–µ–¥–µ–Ω–Ω—ã—Ö –ø–µ—Ä–µ—Ä—ã–≤–æ–≤</p>
                  </div>
                  <div class="schedule-content" id="scheduleContent">
                      <!-- Schedule content will be loaded here -->
                  </div>
              </section>

                <!-- Settings Section -->
                <section id="settingsSection" class="content-section">
                    <div class="section-header">
                        <h2>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ —Å–∏—Å—Ç–µ–º—ã</h2>
                        <p>–ù–∞—Å—Ç—Ä–æ–π–∫–∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è –∏ –ø–∞—Ä–∞–º–µ—Ç—Ä—ã —Å–∏—Å—Ç–µ–º—ã</p>
                    </div>
                    <div class="settings-content" id="settingsContent">
                        <!-- Settings content will be loaded here -->
                    </div>
                </section>
            </div>
        </main>

        <!-- Notification Center -->
        <div id="notificationCenter" class="notification-center"></div>
    </div>

    <!-- Scripts -->
    <!-- Scripts -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/animejs/3.2.1/anime.min.js"></script>
    <!-- Leaflet JS -->
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script src="src/utils/animations.js"></script>
    <script src="src/utils/ExcelParser.js"></script>
    <script src="src/components/MapView/LeafletMap.js"></script> <!-- –ù–æ–≤—ã–π —Ñ–∞–π–ª -->
    <script src="src/components/DataTable.js"></script>
    <script src="src/app.js"></script>
    <script>
        function updateDateTime() {
            const now = new Date();
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –≤—Ä–µ–º—è
            const time = now.toLocaleTimeString('ru-RU', {
                hour: '2-digit',
                minute: '2-digit',
                second: '2-digit'
            });
            
            // –§–æ—Ä–º–∞—Ç–∏—Ä—É–µ–º –¥–∞—Ç—É –≤ –∫–æ–º–ø–∞–∫—Ç–Ω–æ–º —Ñ–æ—Ä–º–∞—Ç–µ –î–î.–ú–ú.–ì–ì–ì–ì
            const date = now.toLocaleDateString('ru-RU', {
                day: '2-digit',
                month: '2-digit',
                year: 'numeric'
            });
            
            document.getElementById('currentTime').textContent = time;
            document.getElementById('currentDate').textContent = date;
        }

        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—Ä–∞–∑—É –∏ –∫–∞–∂–¥—É—é —Å–µ–∫—É–Ω–¥—É
        updateDateTime();
        setInterval(updateDateTime, 1000);
    </script>
<script>
        // –ü—Ä–æ–≤–µ—Ä–∫–∞ –∞–≤—Ç–æ—Ä–∏–∑–∞—Ü–∏–∏ –ø—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ –æ—Å–Ω–æ–≤–Ω–æ–≥–æ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
        document.addEventListener('DOMContentLoaded', function() {
            const isLoggedIn = localStorage.getItem('isLoggedIn');
            const userData = localStorage.getItem('currentUser');
            
            if (!isLoggedIn || !userData) {
                // –ï—Å–ª–∏ –Ω–µ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –ø–µ—Ä–µ–Ω–∞–ø—Ä–∞–≤–ª—è–µ–º –Ω–∞ —Å—Ç—Ä–∞–Ω–∏—Ü—É –≤—Ö–æ–¥–∞
                window.location.href = 'auth.html';
                return;
            }

            // –ï—Å–ª–∏ –∞–≤—Ç–æ—Ä–∏–∑–æ–≤–∞–Ω, –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            const user = JSON.parse(userData);
            
            // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏—é –æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª–µ
            const userAvatar = document.getElementById('userAvatar');
            const userName = document.getElementById('userName');
            
            if (userAvatar) userAvatar.textContent = user.avatar;
            if (userName) userName.textContent = user.name;
            
            // –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ–º –æ—Å–Ω–æ–≤–Ω–æ–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
            if (window.app) {
                window.app.init();
            }
        });

        // –§—É–Ω–∫—Ü–∏—è –≤—ã—Ö–æ–¥–∞ –∏–∑ —Å–∏—Å—Ç–µ–º—ã
        window.logout = function() {
            localStorage.removeItem('currentUser');
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'auth.html';
        };
    </script>
</body>
</html>